<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Garden | Gauhar Rustemkyzy</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="nav-menu">
        <a href="index.html">about me</a>
        <a href="digital_garden.html" style="text-decoration: underline; opacity: 1;">digital garden</a>
        <a href="music.html">music</a>
        <a href="multimedia.html">multimedia</a>
        <a href="photography.html">photography</a>
    </nav>

    <header class="header">
        <h1 class="main-name">DIGITAL GARDEN</h1>
        <div class="city">Thoughts & Inspiration</div>
    </header>

    <main class="garden-container">
        <div class="garden-card note">
            <p class="garden-text">"Каждое выступление — это новая история, рассказанная душой."</p>
            <span class="garden-date">03.01.2026</span>
        </div>

        <div class="garden-card">
            <h3>CURRENT INSPIRATION</h3>
            <p>Parisian jazz cellars, the smell of vintage vinyl, and the way light hits the Seine at 6 PM.</p>
        </div>

        <div class="garden-card playlist-mini">
            <h3>MOOD OF THE MONTH</h3>
            <ul>
                <li>• Sade – Smooth Operator</li>
                <li>• Edith Piaf – Hymne à l'amour</li>
                <li>• Erykah Badu – Rimshot</li>
            </ul>
        </div>

        <div class="garden-card photo-note">
            <img src="img/ground3.jpg" alt="Aesthetic">
            <p>Details in the streets.</p>
        </div>

        <div id="dynamic-cards" style="display: contents;"></div>
    </main>

    <div id="garden-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modal-date" class="garden-date"></div>
            <h2 id="modal-title" style="margin-top:20px; font-family: inherit;"></h2>
            <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
            <div id="modal-body" class="garden-text-full" style="white-space:pre-wrap;"></div>
            <div id="modal-tag" class="garden-tag" style="margin-top:20px; color:#e8a7ad; font-weight: bold;"></div>
        </div>
    </div>

    <div class="cursor"></div>
    <div class="cursor-follower"></div>

    <script>
        const tableUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTKkbS1XiHScW-TatqJqcxl8TptJ8fAnbeepQSemxnstIlKxAGb3_2yOQ6akJEo3VQ2Ewi1o0UWCHEN/pub?output=csv';

        // Универсальный парсер CSV
        function parseCSV(text) {
            const result = [];
            let row = [];
            let cell = '';
            let inQuotes = false;
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                let nextChar = text[i+1];
                if (char === '"' && inQuotes && nextChar === '"') { cell += '"'; i++; }
                else if (char === '"') { inQuotes = !inQuotes; }
                else if (char === ',' && !inQuotes) { row.push(cell); cell = ''; }
                else if ((char === '\r' || char === '\n') && !inQuotes) {
                    if (cell !== '' || row.length > 0) { row.push(cell); result.push(row); }
                    row = []; cell = '';
                    if (char === '\r' && nextChar === '\n') i++;
                } else { cell += char; }
            }
            if (cell !== '' || row.length > 0) { row.push(cell); result.push(row); }
            return result;
        }

        async function loadGarden() {
            try {
                const response = await fetch(tableUrl);
                const csvData = await response.text();
                const allRows = parseCSV(csvData).slice(1); 
                const container = document.getElementById('dynamic-cards');

                allRows.forEach(cols => {
                    if (cols.length < 2) return;
                    const date = cols[0] ? cols[0].trim() : '';
                    const title = cols[1] ? cols[1].trim() : '';
                    const text = cols[2] ? cols[2].trim() : '';
                    const tag = cols[3] ? cols[3].trim() : '';

                    const card = document.createElement('div');
                    card.className = 'garden-card note'; // Все из таблицы будут розовыми
                    card.style.cursor = 'pointer';
                    
                    card.innerHTML = `
                        <div class="garden-date">${date}</div>
                        ${title ? `<h3>${title}</h3>` : ''}
                        <p class="garden-text">${text.substring(0, 80)}${text.length > 80 ? '...' : ''}</p>
                        <div class="garden-tag">${tag}</div>
                    `;

                    card.onclick = () => {
                        document.getElementById('modal-date').innerText = date;
                        document.getElementById('modal-title').innerText = title;
                        document.getElementById('modal-body').innerText = text;
                        document.getElementById('modal-tag').innerText = tag;
                        document.getElementById('garden-modal').style.display = "block";
                    };
                    container.appendChild(card);
                });
            } catch (e) { console.error(e); }
        }

        // Модалка и Курсор
        const modal = document.getElementById('garden-modal');
        document.querySelector('.close-modal').onclick = () => modal.style.display = "none";
        window.onclick = (e) => { if(e.target === modal) modal.style.display = "none"; };

        const cursor = document.querySelector('.cursor');
        const follower = document.querySelector('.cursor-follower');
        document.addEventListener('mousemove', (e) => {
            if(cursor && follower) {
                cursor.style.left = e.clientX + 'px'; cursor.style.top = e.clientY + 'px';
                follower.style.left = e.clientX + 'px'; follower.style.top = e.clientY + 'px';
            }
        });

        loadGarden();
    </script>
</body>
</html>
